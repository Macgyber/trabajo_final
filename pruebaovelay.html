<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Video Overlay Hover</title>
  <style>
    body {
      margin: 0;
      overflow: hidden; /* Evita scroll cuando el overlay aparece */
    }

    #overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 0;
      pointer-events: none; /* Para que no bloquee el hover del botón */
      transition: opacity 0.5s ease;
    }

    #overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    .loading {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 18px;
      z-index: 11;
    }

    video {
      max-width: 80%;
      max-height: 80%;
      box-shadow: 0 0 30px #fff;
    }

    .button-container {
      position: absolute;
      bottom: 50px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 20px;
      z-index: 10;
    }

    .play-button {
      padding: 20px 40px;
      font-size: 24px;
      cursor: pointer;
      border: none;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    #playButton {
      background-color: #4CAF50;
      color: white;
    }

    #playButton2 {
      background-color: #2196F3;
      color: white;
    }

    #playButton3 {
      background-color: #FF9800;
      color: white;
    }

    .play-button:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    .other-buttons {
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .other-buttons.hidden {
      opacity: 0;
      transform: scale(0.8);
      pointer-events: none;
    }

    .timer {
      display: none;
      font-family: 'Courier New', monospace;
      font-weight: bold;
    }

    .tutorial-text {
      display: inline;
    }

    .play-button:hover .tutorial-text {
      display: none;
    }

    .play-button:hover .timer {
      display: inline;
    }
  </style>
</head>
<body>

  <div class="button-container">
    <button id="playButton" class="play-button">
      <span class="tutorial-text">🎬 Tutorial</span>
      <span class="timer" id="timer">00:00</span>
    </button>
    <button id="playButton2" class="play-button other-buttons">🎵 Comenzar</button>
    <button id="playButton3" class="play-button other-buttons">📹 Niveles</button>
  </div>

  <div id="overlay">
    <video id="video" src="/asset/movie/canciondeltutorial.mp4" preload="auto" muted></video>
  </div>

  <script>
    const button = document.getElementById('playButton');
    const button2 = document.getElementById('playButton2');
    const button3 = document.getElementById('playButton3');
    const overlay = document.getElementById('overlay');
    const video = document.getElementById('video');
    const timer = document.getElementById('timer');
    let countdownInterval;

    // Precargar el video cuando se carga la página
    window.addEventListener('load', () => {
      video.load();
    });

    // Activar audio con cualquier interacción del usuario
    function enableAudio() {
      video.muted = false;
    }

    // Escuchar cualquier interacción del usuario para activar audio
    document.addEventListener('click', enableAudio);
    document.addEventListener('keydown', enableAudio);
    document.addEventListener('touchstart', enableAudio);
    document.addEventListener('mouseenter', enableAudio);
    document.addEventListener('mouseover', enableAudio);
    document.addEventListener('mousemove', enableAudio);
    document.addEventListener('scroll', enableAudio);

    // Función para formatear tiempo (MM:SS)
    function formatTime(seconds) {
      const minutes = Math.floor(seconds / 60);
      const remainingSeconds = Math.floor(seconds % 60);
      return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
    }

    // Función para iniciar el cronómetro regresivo
    function startCountdown() {
      const duration = video.duration;
      let remainingTime = duration;
      
      // Actualizar timer inmediatamente
      timer.textContent = formatTime(remainingTime);
      
      // Iniciar intervalo de cuenta regresiva
      countdownInterval = setInterval(() => {
        remainingTime -= 1;
        timer.textContent = formatTime(remainingTime);
        
        if (remainingTime <= 0) {
          clearInterval(countdownInterval);
          timer.textContent = '00:00';
          // Cuando el video termina, volver a la normalidad
          setTimeout(() => {
            overlay.classList.remove('active');
            button2.classList.remove('hidden');
            button3.classList.remove('hidden');
            video.currentTime = 0;
          }, 1000); // 1 segundo después de que termine
        }
      }, 1000);
    }

    // Función para detener el cronómetro
    function stopCountdown() {
      if (countdownInterval) {
        clearInterval(countdownInterval);
        timer.textContent = '00:00';
      }
    }

    // Función para activar el overlay
    function activateOverlay() {
      // Ocultar otros botones
      button2.classList.add('hidden');
      button3.classList.add('hidden');
      
      // Activar audio automáticamente
      video.muted = false;
      
      // Reproducir video inmediatamente
      video.currentTime = 0;
      video.play().then(() => {
        overlay.classList.add('active');
        // Iniciar cronómetro cuando el video comience
        startCountdown();
      }).catch(error => {
        console.log('Error reproduciendo video:', error);
        // Intentar reproducir sin audio si falla
        video.muted = true;
        video.play().then(() => {
          overlay.classList.add('active');
          startCountdown();
        });
      });
    }

    // Función para desactivar el overlay
    function deactivateOverlay() {
      overlay.classList.remove('active');
      video.pause();
      stopCountdown();
      // Resetear el video para la próxima reproducción
      video.currentTime = 0;
      // Mostrar otros botones inmediatamente
      button2.classList.remove('hidden');
      button3.classList.remove('hidden');
    }

    // Eventos para el primer botón (Tutorial - reproduce video)
    button.addEventListener('mouseenter', activateOverlay);
    button.addEventListener('mouseleave', deactivateOverlay);

    // Eventos para el segundo botón (Comenzar - enlace)
    button2.addEventListener('click', () => {
      window.location.href = 'comenzar.html'; // Cambia por tu URL
    });

    // Eventos para el tercer botón (Niveles - enlace)
    button3.addEventListener('click', () => {
      window.location.href = 'niveles.html'; // Cambia por tu URL
    });
  </script>

</body>
</html>
